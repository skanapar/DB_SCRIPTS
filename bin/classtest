#!/bin/env python

##################################################################################################
# Name:        classtest                                                                         #
# Author:      Randy Johnson                                                                     #
# Description: Learning Python Classes                                                           #
##################################################################################################

from sys          import exit
from Oracle       import RunSqlplus
from Oracle       import ResultSet
    
#### ----------------------------------------------
#### Class Definition
#### ----------------------------------------------
###class Test:
###  def __init__(self, sel):
###    self.table = []
###    self.row_count = 0
###    self.errors = []
###    self.rc = 0
###    self.stdout = ''
###    colsep = '~'
###    Sql  = "set pagesize      0\n"
###    Sql += "set heading     off\n"
###    Sql += "set lines     32767\n"
###    Sql += "set feedback    off\n"
###    Sql += "set echo        off\n"
###    Sql += "set colsep      '" + colsep + "'\n"
###    Sql += "\n"
###    Sql += sel + ';'
###
###    (self.rc, self.stdout, self.errors) = RunSqlplus(Sql, True)
###    if (self.rc == 0):
###      for row in self.stdout.split('\n'):
###        columns = map(str.strip,row.split(colsep))
###        self.table.append(columns)
###      self.row_count = len(self.table)
###    else:
###      self.table.append([])
###      self.row_count = 0
###
###  def print_table(self):
###    for row in self.table:
###      print(row)
###
###  def get_table(self):
###      return self.table
###
###  def get_row_count(self):
###    return self.row_count
###
###  def get_errors(self):
###    return self.errors
###
###  def get_sqlout(self):
###    return self.stdout
###
###  def get_resultcode(self):
###    return self.rc
###
###  #def __del__(self):
###  #  print('Entering: %s' % '__del__')
###
#### ----------------------------------------------
#### Main
#### ----------------------------------------------
Table = ResultSet("select * from dba_users")

rc = Table.get_resultcode()
if (rc == 0):
  tab = Table.get_table()
  for row in tab:
    print('>>>>>>>> Table=%s'% row)
else:  
  rows = Table.get_row_count()
  print('>>>>>>>> Rows=%s' % rows)
  
  stdout = Table.get_sqlout()
  print('>>>>>>>> Stdout=%s' % '\n                '.join(stdout.split('\n')))
  
  errors = Table.get_errors()
  print('>>>>>>>> Errors=%s' % errors)
  
  rc     = Table.get_resultcode()
  print('>>>>>>>> Result Code=%s' % rc)

